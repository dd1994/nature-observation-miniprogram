<view class="index-page" style="padding-top: {{tabTop + 'px'}}">
  <view class="empty-tips" wx:if="{{observationsIsEmpty && !(q.taxon_id || displayRegion.length)}}">
    <view class="slogan">
      <view>记录身边物种</view>
      <view>参与公民科学</view>
    </view>
    <button class="empty-tips__btn" type="primary" bind:tap="onAddIconTap">上传已有照片</button>
    <view class="empty-tips__or">或者</view>
    <button class="empty-tips__btn" type="primary" plain="true" bind:tap="goToExplore">先随便逛逛</button>
  </view>
  <view wx:else>
    <index-tab tabs="{{[{value: 0, title: '记录', num: observationsTotal}, {value: 1, title: '物种', num: taxonTotal}, {value: 2, title: '鉴定', num: idTotal}]}}" bind:onTabChange="activeTabChange" activeTab="{{activeTab}}" bind:refresh="refresh">
    </index-tab>

    <view>
      <view class="search-taxon-info" wx:if="{{q.taxon_id || displayRegion.length}}">
        <view class="search-name-display">
          <text class="search-name-display__item" selectable>{{displayRegion}}</text>
          <text class="search-name-display__item">{{q.taxon_preferred_common_name || q.taxon_name}}</text>
        </view>
        <t-icon class="search-taxon-info__remove-icon" bind:click="removeSearch" name="close" size="52rpx" />
      </view>

      <view class="search-empty-tips" wx:if="{{activeTab === 0 && observationsIsEmpty && (q.taxon_id || q.region)}}">
        <t-empty icon="search" description="搜索结果为空，请尝试其他搜索条件" />
      </view>
    </view>

    <view style="height: {{scollViewHeight  + 'px'}};">
      <block wx:if="{{activeTab === 0}}">
        <observation-list bind:scrolltolower="bindscrolltolower" bind:refresh="resetAndFetchObservations" observations="{{observations}}" userProfile="{{userProfile}}" allLoaded="{{observationsAllLoaded}}"></observation-list>
      </block>
      <block wx:if="{{activeTab === 1}}">
        <taxon-list bind:applyTaxonFilter="applyTaxonFilter" taxon="{{taxon}}" allLoaded="{{taxonAllLoaded}}" bind:scrolltolower="bindscrolltolower"></taxon-list>
      </block>
      <block wx:if="{{activeTab === 2}}">
        <id-list ids="{{ids}}" allLoaded="{{idAllLoaded}}" bind:scrolltolower="bindscrolltolower"></id-list>
      </block>
    </view>
  </view>
  <view class="tab-right-wrapper" style="top: {{filterIconTop + 'px'}};height: {{filterIconHeight+ 'px'}}">

    <picker header-text="按地区过滤" mode="region" bindchange="bindRegionChange" value="{{q.region}}" custom-item="全部">
      <view class="picker">
        <view hover-class="common-hover-class" class="filter-location-icon">
          <t-icon size="20px" color="rgba(0,0,0,0.9)" name="location" />
        </view>
      </view>
    </picker>

    <view hover-class="common-hover-class" class="filter-icon">
      <t-icon bind:click="gotoIndexFilter" size="20px" color="rgba(0,0,0,0.9)" name="filter-1" />
    </view>

    <view hover-class="common-hover-class" class="search-icon">
      <t-icon bind:click="gotoIndexSearch" size="20px" color="rgba(0,0,0,0.9)" name="search" />
    </view>
  </view>
  <fab icon="add" wx:if="{{!observationsIsEmpty}}" bind:tap="onAddIconTap"></fab>
</view>